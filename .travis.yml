language: rust
rust:
- stable
- nightly

jobs:
  include:
    - stage: test
      env: TARGET="x86_64-unknown-linux-gnu"
      script:
        - cargo build
        - cargo build --features=stream
        - cargo test
        - cargo test --features=stream
    - stage: test
      env: TARGET="x86_64-unknown-linux-musl"
      script:
        - cargo build
        - cargo build --features=stream
        - cargo test
        - cargo test --features=stream
