language: rust

jobs:
  include:
    - stage: test
      env: TARGET="x86_64-unknown-linux-gnu"
      rust: stable
      script:
        - cargo build
        - cargo build --features=stream
        - cargo test
        - cargo test --features=stream
    - stage: test
      env: TARGET="x86_64-unknown-linux-gnu"
      rust: nightly 
      script:
        - cargo build
        - cargo build --features=stream
        - cargo test
        - cargo test --features=stream
    - stage: test
      env: TARGET="x86_64-unknown-linux-musl"
      rust: stable
      script:
        - cargo build
        - cargo build --features=stream
        - cargo test
        - cargo test --features=stream
    - stage: test
      env: TARGET="x86_64-unknown-linux-musl"
      rust: nightly
      script:
        - cargo build
        - cargo build --features=stream
        - cargo test
        - cargo test --features=stream
